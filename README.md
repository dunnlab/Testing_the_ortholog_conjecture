
## Introduction

This repository contains files associated with our manuscript: "Phylogenetic comparative methods are problematic when applied to gene trees with speciation and duplication nodes: correcting for biases in testing the ortholog conjecture". This analysis is based on reanalyses of a published paper by Dunn et al. (doi:10.1073/pnas.1707515115).

## Brief Description of files

The files include:

- `Manuscript.Rmd` This file contains detailed text of our manuscript and the codes to reproduce our results.  

- `Premanuscript_run_TM.R` To save time during knitting of the `Manuscript.Rmd` file, one needs to run this script first. The outputs are generated and saved as `Data_TMRR.rda`, also available in https://doi.org/10.5281/zenodo.3354285.

- `functions_Dunn.R` The script adopted from Dunn et al. and renamed. The script contains functions, which were used to reproduce the results of Dunn et al. Some of the functions were further used in our study.      

- `funtion_TM_new.R` Additional script of functions written for our analysis.

- `plos.csl` CSL style used in our Manuscript.Rmd file.

- `TM.bib` The Bibliography file of our Rmarkdown file. 

These analyses build on the analyses of Dunn et al. Specifically, we import the data file `manuscript.RData` generated by their script [manuscript_kernel.R](https://github.com/caseywdunn/comparative_expression_2017/blob/master/manuscript_kernel.R). We assume this file is in the root directory of this repository and that it is renamed `manuscript_dunn.RData`. This file includes a variety of objects, including the compara gene tree file (ftp://ftp.ensembl.org/pub/release-75/emf/ensembl-compara/homologies/).


## Rerunning our analyses

To re-execute our manuscript:

1. Clone htis repository.
2. Download the two RData files available at https://doi.org/10.5281/zenodo.3354285, and place them in the root of the repository directory. These are the rdata file from the manuscript of Dunn et al., and the rdata file generated by our script `Premanuscript_run_TM.R`.
3. Knit `Manuscript.Rmd`.

To rerun all our analyses, you can also execute `Premanuscript_run_TM.R`, which will regenerate the file `Data_TMRR.rda`.

